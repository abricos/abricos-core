YAHOO.util.Connect={_msxml_progid:["Microsoft.XMLHTTP","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"],_http_headers:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:"application/x-www-form-urlencoded; charset=UTF-8",_default_form_header:"application/x-www-form-urlencoded",_use_default_xhr_header:true,_default_xhr_header:"XMLHttpRequest",_has_default_headers:true,_isFormSubmit:false,_default_headers:{},_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,startEvent:new YAHOO.util.CustomEvent("start"),completeEvent:new YAHOO.util.CustomEvent("complete"),successEvent:new YAHOO.util.CustomEvent("success"),failureEvent:new YAHOO.util.CustomEvent("failure"),abortEvent:new YAHOO.util.CustomEvent("abort"),_customEvents:{onStart:["startEvent","start"],onComplete:["completeEvent","complete"],onSuccess:["successEvent","success"],onFailure:["failureEvent","failure"],onUpload:["uploadEvent","upload"],onAbort:["abortEvent","abort"]},setProgId:function(A){this._msxml_progid.unshift(A);},setDefaultPostHeader:function(A){if(typeof A=="string"){this._default_post_header=A;this._use_default_post_header=true;}else{if(typeof A=="boolean"){this._use_default_post_header=A;}}},setDefaultXhrHeader:function(A){if(typeof A=="string"){this._default_xhr_header=A;}else{this._use_default_xhr_header=A;}},setPollingInterval:function(A){if(typeof A=="number"&&isFinite(A)){this._polling_interval=A;}},createXhrObject:function(F){var D,A,B;try{A=new XMLHttpRequest();D={conn:A,tId:F,xhr:true};}catch(C){for(B=0;B<this._msxml_progid.length;++B){try{A=new ActiveXObject(this._msxml_progid[B]);D={conn:A,tId:F,xhr:true};break;}catch(E){}}}finally{return D;}},getConnectionObject:function(A){var C,D=this._transaction_id;try{if(!A){C=this.createXhrObject(D);}else{C={tId:D};if(A==="xdr"){C.conn=this._transport;C.xdr=true;}else{if(A==="upload"){C.upload=true;}}}if(C){this._transaction_id++;}}catch(B){}return C;},asyncRequest:function(H,D,G,A){var B=G&&G.argument?G.argument:null,E=this,F,C;if(this._isFileUpload){C="upload";}else{if(G&&G.xdr){C="xdr";}}F=this.getConnectionObject(C);if(!F){return null;}else{if(G&&G.customevents){this.initCustomEvents(F,G);}if(this._isFormSubmit){if(this._isFileUpload){window.setTimeout(function(){E.uploadFile(F,G,D,A);},10);return F;}if(H.toUpperCase()=="GET"){if(this._sFormData.length!==0){D+=((D.indexOf("?")==-1)?"?":"&")+this._sFormData;}}else{if(H.toUpperCase()=="POST"){A=A?this._sFormData+"&"+A:this._sFormData;}}}if(H.toUpperCase()=="GET"&&(G&&G.cache===false)){D+=((D.indexOf("?")==-1)?"?":"&")+"rnd="+new Date().valueOf().toString();}if(this._use_default_xhr_header){if(!this._default_headers["X-Requested-With"]){this.initHeader("X-Requested-With",this._default_xhr_header,true);}}if((H.toUpperCase()==="POST"&&this._use_default_post_header)&&this._isFormSubmit===false){this.initHeader("Content-Type",this._default_post_header);}if(F.xdr){this.xdr(F,H,D,G,A);return F;}F.conn.open(H,D,true);if(this._has_default_headers||this._has_http_headers){this.setHeader(F);}this.handleReadyState(F,G);F.conn.send(A||"");if(this._isFormSubmit===true){this.resetFormState();}this.startEvent.fire(F,B);if(F.startEvent){F.startEvent.fire(F,B);}return F;}},initCustomEvents:function(A,C){var B;for(B in C.customevents){if(this._customEvents[B][0]){A[this._customEvents[B][0]]=new YAHOO.util.CustomEvent(this._customEvents[B][1],(C.scope)?C.scope:null);A[this._customEvents[B][0]].subscribe(C.customevents[B]);}}},handleReadyState:function(C,D){var B=this,A=(D&&D.argument)?D.argument:null;if(D&&D.timeout){this._timeOut[C.tId]=window.setTimeout(function(){B.abort(C,D,true);},D.timeout);}this._poll[C.tId]=window.setInterval(function(){if(C.conn&&C.conn.readyState===4){window.clearInterval(B._poll[C.tId]);delete B._poll[C.tId];if(D&&D.timeout){window.clearTimeout(B._timeOut[C.tId]);delete B._timeOut[C.tId];}B.completeEvent.fire(C,A);if(C.completeEvent){C.completeEvent.fire(C,A);}B.handleTransactionResponse(C,D);}},this._polling_interval);},handleTransactionResponse:function(B,I,D){var E,A,G=(I&&I.argument)?I.argument:null,C=(B.r&&B.r.statusText==="xdr:success")?true:false,H=(B.r&&B.r.statusText==="xdr:failure")?true:false,J=D;try{if((B.conn.status!==undefined&&B.conn.status!==0)||C){E=B.conn.status;}else{if(H&&!J){E=0;}else{E=13030;}}}catch(F){E=13030;}if((E>=200&&E<300)||E===1223||C){A=B.xdr?B.r:this.createResponseObject(B,G);if(I&&I.success){if(!I.scope){I.success(A);}else{I.success.apply(I.scope,[A]);}}this.successEvent.fire(A);if(B.successEvent){B.successEvent.fire(A);}}else{switch(E){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:A=this.createExceptionObject(B.tId,G,(D?D:false));if(I&&I.failure){if(!I.scope){I.failure(A);}else{I.failure.apply(I.scope,[A]);}}break;default:A=(B.xdr)?B.response:this.createResponseObject(B,G);if(I&&I.failure){if(!I.scope){I.failure(A);}else{I.failure.apply(I.scope,[A]);}}}this.failureEvent.fire(A);if(B.failureEvent){B.failureEvent.fire(A);}}this.releaseObject(B);A=null;},createResponseObject:function(A,G){var D={},I={},E,C,F,B;try{C=A.conn.getAllResponseHeaders();F=C.split("\n");for(E=0;E<F.length;E++){B=F[E].indexOf(":");if(B!=-1){I[F[E].substring(0,B)]=YAHOO.lang.trim(F[E].substring(B+2));}}}catch(H){}D.tId=A.tId;D.status=(A.conn.status==1223)?204:A.conn.status;D.statusText=(A.conn.status==1223)?"No Content":A.conn.statusText;D.getResponseHeader=I;D.getAllResponseHeaders=C;D.responseText=A.conn.responseText;D.responseXML=A.conn.responseXML;if(G){D.argument=G;}return D;},createExceptionObject:function(H,D,A){var F=0,G="communication failure",C=-1,B="transaction aborted",E={};E.tId=H;if(A){E.status=C;E.statusText=B;}else{E.status=F;E.statusText=G;}if(D){E.argument=D;}return E;},initHeader:function(A,D,C){var B=(C)?this._default_headers:this._http_headers;B[A]=D;if(C){this._has_default_headers=true;}else{this._has_http_headers=true;}},setHeader:function(A){var B;if(this._has_default_headers){for(B in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,B)){A.conn.setRequestHeader(B,this._default_headers[B]);
}}}if(this._has_http_headers){for(B in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,B)){A.conn.setRequestHeader(B,this._http_headers[B]);}}this._http_headers={};this._has_http_headers=false;}},resetDefaultHeaders:function(){this._default_headers={};this._has_default_headers=false;},abort:function(E,G,A){var D,B=(G&&G.argument)?G.argument:null;E=E||{};if(E.conn){if(E.xhr){if(this.isCallInProgress(E)){E.conn.abort();window.clearInterval(this._poll[E.tId]);delete this._poll[E.tId];if(A){window.clearTimeout(this._timeOut[E.tId]);delete this._timeOut[E.tId];}D=true;}}else{if(E.xdr){E.conn.abort(E.tId);D=true;}}}else{if(E.upload){var C="yuiIO"+E.tId;var F=document.getElementById(C);if(F){YAHOO.util.Event.removeListener(F,"load");document.body.removeChild(F);if(A){window.clearTimeout(this._timeOut[E.tId]);delete this._timeOut[E.tId];}D=true;}}else{D=false;}}if(D===true){this.abortEvent.fire(E,B);if(E.abortEvent){E.abortEvent.fire(E,B);}this.handleTransactionResponse(E,G,true);}return D;},isCallInProgress:function(A){A=A||{};if(A.xhr&&A.conn){return A.conn.readyState!==4&&A.conn.readyState!==0;}else{if(A.xdr&&A.conn){return A.conn.isCallInProgress(A.tId);}else{if(A.upload===true){return document.getElementById("yuiIO"+A.tId)?true:false;}else{return false;}}}},releaseObject:function(A){if(A&&A.conn){A.conn=null;A=null;}}};(function(){var G=YAHOO.util.Connect,H={};function D(I){var J='<object id="YUIConnectionSwf" type="application/x-shockwave-flash" data="'+I+'" width="0" height="0">'+'<param name="movie" value="'+I+'">'+'<param name="allowScriptAccess" value="always">'+"</object>",K=document.createElement("div");document.body.appendChild(K);K.innerHTML=J;}function B(L,I,J,M,K){H[parseInt(L.tId)]={"o":L,"c":M};if(K){M.method=I;M.data=K;}L.conn.send(J,M,L.tId);}function E(I){D(I);G._transport=document.getElementById("YUIConnectionSwf");}function C(){G.xdrReadyEvent.fire();}function A(J,I){if(J){G.startEvent.fire(J,I.argument);if(J.startEvent){J.startEvent.fire(J,I.argument);}}}function F(J){var K=H[J.tId].o,I=H[J.tId].c;if(J.statusText==="xdr:start"){A(K,I);return;}J.responseText=decodeURI(J.responseText);K.r=J;if(I.argument){K.r.argument=I.argument;}this.handleTransactionResponse(K,I,J.statusText==="xdr:abort"?true:false);delete H[J.tId];}G.xdr=B;G.swf=D;G.transport=E;G.xdrReadyEvent=new YAHOO.util.CustomEvent("xdrReady");G.xdrReady=C;G.handleXdrResponse=F;})();(function(){var E=YAHOO.util.Connect,G=YAHOO.util.Event,A=document.documentMode?document.documentMode:false;E._isFileUpload=false;E._formNode=null;E._sFormData=null;E._submitElementValue=null;E.uploadEvent=new YAHOO.util.CustomEvent("upload");E._hasSubmitListener=function(){if(G){G.addListener(document,"click",function(K){var J=G.getTarget(K),I=J.nodeName.toLowerCase();if((I==="input"||I==="button")&&(J.type&&J.type.toLowerCase()=="submit")){E._submitElementValue=encodeURIComponent(J.name)+"="+encodeURIComponent(J.value);}});return true;}return false;}();function H(U,P,K){var T,J,S,Q,X,R=false,N=[],W=0,M,O,L,V,I;this.resetFormState();if(typeof U=="string"){T=(document.getElementById(U)||document.forms[U]);}else{if(typeof U=="object"){T=U;}else{return;}}if(P){this.createFrame(K?K:null);this._isFormSubmit=true;this._isFileUpload=true;this._formNode=T;return;}for(M=0,O=T.elements.length;M<O;++M){J=T.elements[M];X=J.disabled;S=J.name;if(!X&&S){S=encodeURIComponent(S)+"=";Q=encodeURIComponent(J.value);switch(J.type){case"select-one":if(J.selectedIndex>-1){I=J.options[J.selectedIndex];N[W++]=S+encodeURIComponent((I.attributes.value&&I.attributes.value.specified)?I.value:I.text);}break;case"select-multiple":if(J.selectedIndex>-1){for(L=J.selectedIndex,V=J.options.length;L<V;++L){I=J.options[L];if(I.selected){N[W++]=S+encodeURIComponent((I.attributes.value&&I.attributes.value.specified)?I.value:I.text);}}}break;case"radio":case"checkbox":if(J.checked){N[W++]=S+Q;}break;case"file":case undefined:case"reset":case"button":break;case"submit":if(R===false){if(this._hasSubmitListener&&this._submitElementValue){N[W++]=this._submitElementValue;}R=true;}break;default:N[W++]=S+Q;}}}this._isFormSubmit=true;this._sFormData=N.join("&");this.initHeader("Content-Type",this._default_form_header);return this._sFormData;}function D(){this._isFormSubmit=false;this._isFileUpload=false;this._formNode=null;this._sFormData="";}function C(I){var J="yuiIO"+this._transaction_id,L=(A===9)?true:false,K;if(YAHOO.env.ua.ie&&!L){K=document.createElement('<iframe id="'+J+'" name="'+J+'" />');if(typeof I=="boolean"){K.src="javascript:false";}}else{K=document.createElement("iframe");K.id=J;K.name=J;}K.style.position="absolute";K.style.top="-1000px";K.style.left="-1000px";document.body.appendChild(K);}function F(I){var L=[],J=I.split("&"),K,M;for(K=0;K<J.length;K++){M=J[K].indexOf("=");if(M!=-1){L[K]=document.createElement("input");L[K].type="hidden";L[K].name=decodeURIComponent(J[K].substring(0,M));L[K].value=decodeURIComponent(J[K].substring(M+1));this._formNode.appendChild(L[K]);}}return L;}function B(L,W,M,K){var R="yuiIO"+L.tId,S="multipart/form-data",U=document.getElementById(R),N=(A>=8)?true:false,X=this,T=(W&&W.argument)?W.argument:null,V,Q,J,P,I,O;I={action:this._formNode.getAttribute("action"),method:this._formNode.getAttribute("method"),target:this._formNode.getAttribute("target")};this._formNode.setAttribute("action",M);this._formNode.setAttribute("method","POST");this._formNode.setAttribute("target",R);if(YAHOO.env.ua.ie&&!N){this._formNode.setAttribute("encoding",S);}else{this._formNode.setAttribute("enctype",S);}if(K){V=this.appendPostData(K);}this._formNode.submit();this.startEvent.fire(L,T);if(L.startEvent){L.startEvent.fire(L,T);}if(W&&W.timeout){this._timeOut[L.tId]=window.setTimeout(function(){X.abort(L,W,true);},W.timeout);}if(V&&V.length>0){for(Q=0;Q<V.length;Q++){this._formNode.removeChild(V[Q]);}}for(J in I){if(YAHOO.lang.hasOwnProperty(I,J)){if(I[J]){this._formNode.setAttribute(J,I[J]);}else{this._formNode.removeAttribute(J);}}}this.resetFormState();
O=function(){if(W&&W.timeout){window.clearTimeout(X._timeOut[L.tId]);delete X._timeOut[L.tId];}X.completeEvent.fire(L,T);if(L.completeEvent){L.completeEvent.fire(L,T);}P={tId:L.tId,argument:T};try{P.responseText=U.contentWindow.document.body?U.contentWindow.document.body.innerHTML:U.contentWindow.document.documentElement.textContent;P.responseXML=U.contentWindow.document.XMLDocument?U.contentWindow.document.XMLDocument:U.contentWindow.document;}catch(Y){}if(W&&W.upload){if(!W.scope){W.upload(P);}else{W.upload.apply(W.scope,[P]);}}X.uploadEvent.fire(P);if(L.uploadEvent){L.uploadEvent.fire(P);}G.removeListener(U,"load",O);setTimeout(function(){document.body.removeChild(U);X.releaseObject(L);},100);};G.addListener(U,"load",O);}E.setForm=H;E.resetFormState=D;E.createFrame=C;E.appendPostData=F;E.uploadFile=B;})();YAHOO.register("connection",YAHOO.util.Connect,{version:"@VERSION@",build:"@BUILD@"});